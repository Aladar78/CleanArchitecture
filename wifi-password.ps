$wifiDetails = netsh wlan show profiles | Select-String "All User Profile" | ForEach-Object {
    $profile = $_.Line.Split(":")[1].Trim()
    $passwordLine = netsh wlan show profile name=$profile key=clear | Select-String "Key Content"
    $password = if ($passwordLine) { $passwordLine.Line.Split(":")[1].Trim() } else { "*****" }
    [PSCustomObject]@{ "Wi-Fi Name (SSID)" = $profile; "Password" = $password }
}
$wifiDetails | Format-Table -AutoSize
